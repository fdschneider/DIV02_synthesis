---
title: "Notes on Arthropod Data"
author: "Florian D. Schneider"
date: "`r Sys.Date()`"
output:
  tufte::tufte_html: default
  tufte::tufte_handout:
    citation_package: natbib
    latex_engine: xelatex
  tufte::tufte_book:
    citation_package: natbib
    latex_engine: xelatex
---

# Data availability

## Abundance data

The data from the core Arthropod project are available for the years 2008 -- 2011. The years 2012 and 2013 are currently being prepared by Martin Goßner. 

Fig. 1 provides an overview of the plots and sampling replicates over time. 

```{r, echo = FALSE}

arthropods_core <- read.csv2("data/arthropods_core/Arthropods_GL_0813.csv")
predators_core <- subset(arthropods_core, Feeding_guild == "c")
herbivores_core <- subset(arthropods_core, Feeding_guild %in% c("h","o"))

monthvec <- c("Jan", "Feb", "Mär", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez")

plot(I(CollectionYear+match(CollectionMonth, monthvec)/12) ~ as.integer(PlotID) , data = arthropods_core, pch = 20, xaxt = "n", col = selector+1, yaxt = "n", ylim = c(2008,2013))
axis(2, at = 2008:2012)
axis(1, at = 1:150, labels = levels(arthropods_core$PlotID), las = 2)
# lapply(unique( arthropods_core$CollectionYear), function(y) unique(subset(arthropods_core, CollectionYear == y)$CollectionMonth) )  # check which months were sampled each year
axis(4, at = seq(2008,2012, 1/12)[-1], labels = rep(month.abb, 4), las = 1, cex = 0.6)
abline(h = seq(2008,2012, 1/12)[-1], col = "#00000020")
abline(h = 2008:2012)
abline(v = 1:150, col = "#00000020" )
```

 
There is an issue with the inconsistency of the number of replicates per year per plot. VIPs have been sampled four to six times, while most EPs have been sampled only twice until 2010. After 2011 they have been sampled five or six times. For calculating the community weighted means, I will have to sum the species numbers and devide by the number of replicates. When it comes to measures of variation, it will be heterogeneous just because of the difference in n. I guess this means that I need to either form subsets with only two replicates per year taken into account even for VIPs (June and August). 

Martin confirmed this issue and also the use of the data selection process. For the data of Schorfheide, there was a shift in the sampling month in 2009, which has to be taken into account.  He promised to send me a dataset that is readily compiled and includes abundance data summed over the two sampling events per year.

## Trait data

Trait data originate from two sources. First, the database compiled by Martin Gossner and Nadja Simons:

> Gossner MM, Simons NK, Achtziger R, Blick T, Dorow WHO, Dziock F, Köhler F, Rabitsch W, Weisser WW (2015) A summary of eight traits of Coleoptera, Hemiptera, Orthoptera and Araneae, occurring in grasslands in Germany. Scientific Data 2: 150013. http://dx.doi.org/10.1038/sdata.2015.13 and Data http://dx.doi.org/10.5061/dryad.53ds2

This database is covering most of the species that occur in the abundance data and includes nine traits: 
 
- body size [mm]
- dispersal ability: defined as no dispersal (0), low passive dispersal (0.25), minor flying ability for movement and colonization (0.5), average individual movement and colonization dynamics (0.75) and high individual movment and colonization (floating, 1.0)
- feeding guild: classified as consumer (c), detritivore (d), herbivore (h), fungivore (f), and omnivore (o)
- feeding mode: classified as chewers (c), extraintestinal (e), and suction feeding (s)
- feeding specialisation (within herbivores): 
- feeding tissue (within herbivorous suckers): 
- feeding plant part (within herbivorous chewers):
- endophagous lifestyle (within herbivores): 
- stratum use: ground (g), stem (s), 

```{r, fig.height = 7, fig.width = 3}

library(rgl)
library(vegan)
library(labdsv)
library(geometry)

load("data/cwm_herbivores.rData")
load("data/cwm_predators.rData")
load("data/lui.rData")
load("data/arthropod_trait_matrix.rData")
source("R/cwm.r")
source("R/crystalplot.r")
source("R/trait_pca.r")

par(mfrow = c(2,1))

trait_pca(cwm_herbivores, log = FALSE)
trait_pca(cwm_predators, log = FALSE)

```
